(this.webpackJsonptravelata=this.webpackJsonptravelata||[]).push([[0],[,,,,,,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var c=n(0),r=n(1),a=n.n(r),o=n(4),d=n.n(o),s=(n(10),n(2)),i=(n(11),n(12),n(13),a.a.createContext());n(14);var u=function(t){var e=t.content,n=t.clickHandler,r=t.id,a=t.disabled,o=t.operation,d=t.classButton;return Object(c.jsx)("button",{onClick:function(){return n(r,o)},className:"button "+(a?"button--disabled ":"")+d,disabled:a,children:e})};var l=function(t){var e=t.card,n=t.index,a=Object(r.useContext)(i).setCart,o=e.amount-(e.countAddToCart||0),d=e.maxPerPerson===(e.countAddToCart||0),s=!o||d;return Object(c.jsx)("li",{className:"card",children:Object(c.jsxs)("p",{className:"card__wrap",children:[Object(c.jsx)("b",{className:"card__index",children:n+1}),Object(c.jsxs)("span",{className:"card__text",children:["\u041e\u0441\u0442\u0430\u043b\u043e\u0441\u044c ",o," ",e.productName," \u043f\u043e ",e.price," \u0440\u0443\u0431\u043b\u0435\u0439"]}),Object(c.jsx)(u,{id:e.id,disabled:s,clickHandler:a,classButton:"card__button",operation:"add",content:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443"})]})})};var j=function(t){var e=t.cards,n=t.categoryCount;return Object(c.jsxs)("section",{className:"card-list",children:[Object(c.jsxs)("h2",{children:["\u0418\u043c\u0435\u044e\u0449\u0438\u0435\u0441\u044f \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 ",n]}),Object(c.jsx)("ul",{className:"card-list__list",children:e.map((function(t,e){return Object(c.jsx)(l,{card:t,index:e},t.id)}))})]})};n(15);var b=function(t){var e=t.card,n=t.count,a=t.sum,o=Object(r.useContext)(i).setCart,d=e.maxPerPerson===(e.countAddToCart||0);return Object(c.jsx)("li",{className:"CartItem",children:Object(c.jsxs)("p",{children:["\u0422\u0435\u043b\u0435\u0444\u043e\u043d (",Object(c.jsx)(u,{id:e.id,clickHandler:o,classButton:"cart-item__button-remove",operation:"remove",content:"-"}),n," \u0448\u0442",Object(c.jsx)(u,{id:e.id,clickHandler:o,disabled:d,classButton:"cart-item__button-add",operation:"add",content:"+"}),") \u043d\u0430 \u0441\u0443\u043c\u043c\u0443 ",a," \u0440\u0443\u0431\u043b\u0435\u0439 (",Object(c.jsx)(u,{id:e.id,clickHandler:o,operation:"clear",content:"\u0443\u0434\u0430\u043b\u0438\u0442\u044c"}),")"]})})};n(16);var f=function(t){var e=t.cards.filter((function(t){return t.countAddToCart})),n=e.reduce((function(t,e){return t+e.countAddToCart*e.price}),0),r=e.reduce((function(t,e){return t+e.countAddToCart}),0);return Object(c.jsx)("div",{className:"cart",children:e.length?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("h2",{children:["\u0412 \u043a\u043e\u0440\u0437\u0438\u043d\u0435 ",r," \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u043d\u0430 \u0441\u0443\u043c\u043c\u0443 ",n," \u0440\u0443\u0431\u043b\u0435\u0439"]}),Object(c.jsx)("ol",{children:e.map((function(t,e){return Object(c.jsx)(b,{card:t,index:e,count:t.countAddToCart,sum:t.price*t.countAddToCart},t.id)}))})]}):Object(c.jsx)("p",{children:"\u041a\u043e\u0440\u0437\u0438\u043d\u0430 \u043f\u0443\u0441\u0442\u0430"})})};var x=function(t,e){if(!e)return JSON.parse(localStorage.getItem(t));localStorage.setItem(t,JSON.stringify(e))};var O=function(){var t=a.a.useState(x("cards")||[]),e=Object(s.a)(t,2),n=e[0],o=e[1],d=a.a.useState(!0),u=Object(s.a)(d,2),l=u[0],b=u[1],O=a.a.useState(0),m=Object(s.a)(O,2),h=m[0],v=m[1];function p(t){return t.filter((function(t){return function(t){var e=t.countAddToCart||0;return t.amount-e>0&&t.maxPerPerson-e>0}(t)})).length}return Object(r.useEffect)((function(){n.length?(o(n),v(p(n)),b(!1)):fetch("https://my-json-server.typicode.com/alex-koshara/travelata_testing/products?_limit=5").then((function(t){return t.json()})).then((function(t){o(t),v(p(t)),b(!1)}))}),[]),Object(r.useEffect)((function(){v(p(n)),o(n),x("cards",n)}),[n]),Object(c.jsx)(i.Provider,{value:{setCart:function(t,e){var c=function(t,e){return t.find((function(t){return t.id===e}))}(n,t);!function(t,e){switch(t.countAddToCart=t.countAddToCart||0,e){case"add":return t.countAddToCart++;case"remove":return t.countAddToCart--;case"clear":return t.countAddToCart=0;default:;}}(c,e),o(n.map((function(t){return t.id===c.id&&(n.countAddToCart=c.countAddToCart),t})))}},children:Object(c.jsx)("div",{className:"container",children:n.length?Object(c.jsxs)("div",{className:"main",children:[Object(c.jsx)(j,{cards:n,categoryCount:h}),Object(c.jsx)(f,{cards:n})]}):l?null:Object(c.jsx)("p",{children:"No cards"})})})};d.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(O,{})}),document.getElementById("root"))}],[[17,1,2]]]);
//# sourceMappingURL=main.1323ec4c.chunk.js.map