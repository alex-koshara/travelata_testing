{"version":3,"sources":["components/Button/Button.js","context.js","components/Card/Card.js","components/CardList/CardList.js","components/CartItem/CartItem.js","components/Cart/Cart.js","utils/storage.js","App.js","index.js"],"names":["Button","content","clickHandler","id","disabled","operation","classButton","onClick","className","Context","React","createContext","plural","require","Card","card","index","setCart","useContext","amount","countAddToCart","amountPerPerson","maxPerPerson","isDisabledCardButton","isMaxPerPerson","name","productName","price","CardList","cards","categoryCount","map","CartItem","count","sum","Cart","cardsToCart","filter","cartSum","reduce","cardCount","length","storage","key","data","JSON","parse","localStorage","getItem","setItem","stringify","clearStorage","clear","window","location","reload","console","log","App","useState","setCards","loading","setLoading","setCategoryCount","recalculateCategoty","cartCount","checkAmount","useEffect","fetch","then","response","json","Provider","value","currentCard","find","getCurrentCard","setCountCardToCart","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.04f74312.chunk.js","sourcesContent":["import React from 'react';\nimport './Button.css'\n\nfunction Button({content, clickHandler, id, disabled, operation, classButton}) {\n  return (\n      <button\n        onClick={() => clickHandler(id, operation)}\n        className={\"button \" + (disabled ? 'button--disabled ' : '') + classButton}\n        disabled={disabled}>\n          {content}\n      </button>\n  )\n}\n\nexport default Button;","import React from 'react';\n\nconst Context = React.createContext();\n\nexport default Context;\n","import React, { useContext } from 'react';\nimport './Card.css';\nimport Context from '../../context';\nimport Button from '../Button/Button';\nconst plural = require('plural-ru');\n\nfunction Card({card, index}) {\n  const {setCart} = useContext(Context);\n  const amount = card.amount - (card.countAddToCart || 0);\n  const amountPerPerson = card.maxPerPerson === (card.countAddToCart || 0);\n  const isDisabledCardButton = !amount || amountPerPerson;\n  const isMaxPerPerson = amount > 0 && amountPerPerson;\n  const name = card.productName;\n\n  return (\n    <li className=\"card\">\n      <p className=\"card__wrap\">\n        <b className=\"card__index\">{index + 1}</b>\n        <span className=\"card__text\">Осталось {amount} {plural(amount, name, name + 'a', name + 'ов')} по {card.price} рублей</span>\n        <Button\n          id={card.id}\n          disabled={isDisabledCardButton}\n          clickHandler={setCart}\n          classButton='card__button'\n          operation='add'\n          content='Добавить в корзину'/>\n      </p>\n      {isMaxPerPerson && <span className=\"card__max-per-person\">К сожалению данный товар ограничен за одну покупку. Вы можете приобрести не более {card.maxPerPerson} шт.</span>}\n    </li>\n  )\n}\n\nexport default Card;","import React from 'react';\nimport './CardList.css'\nimport Card from '../Card/Card';\n\nfunction CardList({cards, categoryCount}) {\n\n  return (\n    <section className=\"card-list\">\n      <h2>Имеющиеся категории товаров {categoryCount}</h2>\n      <ul className=\"card-list__list\">\n        {cards.map((card, index) => {\n          return (\n            <Card\n              key={card.id}\n              card={card}\n              index={index}\n            />\n          )\n        })}\n      </ul>\n    </section>\n  )\n}\n\nexport default CardList;","import React, { useContext } from 'react';\nimport './CartItem.css'\nimport Context from '../../context';\nimport Button from '../Button/Button';\n\nfunction CartItem({card, count, sum}) {\n  const {setCart} = useContext(Context);\n  const amountPerPerson = card.maxPerPerson === (card.countAddToCart || 0);\n  const isDisabledCardButton = amountPerPerson;\n\n  return (\n      <li className=\"CartItem\">\n        <p>{card.productName} (\n          <Button\n            id={card.id}\n            clickHandler={setCart}\n            classButton='cart-item__button-remove'\n            operation='remove'\n            content='-'/>\n              {count} шт\n          <Button\n            id={card.id}\n            clickHandler={setCart}\n            disabled={isDisabledCardButton}\n            classButton='cart-item__button-add'\n            operation='add'\n            content='+'/>\n              ) на сумму {sum} рублей (\n          <Button\n            id={card.id}\n            clickHandler={setCart}\n            operation='clear'\n            content='удалить'/>\n          )\n        </p>\n      </li>\n  )\n}\n\nexport default CartItem;","import React from 'react';\nimport CartItem from '../CartItem/CartItem';\nimport './Cart.css';\nconst plural = require('plural-ru');\n\nfunction Cart({cards}) {\n  const cardsToCart = cards.filter(card => card.countAddToCart);\n  const cartSum = cardsToCart.reduce((sum, card) => {\n    return sum + (card.countAddToCart * card.price)\n  }, 0);\n  const cardCount = cardsToCart.reduce((sum, card) => {\n    return sum + card.countAddToCart\n  }, 0)\n\n  return (\n    <div className=\"cart\">\n      {\n        cardsToCart.length\n        ? (\n            <>\n              <h2>В корзине {cardCount} {plural(cardCount, 'товар', 'товара', 'товаров')} на сумму {cartSum} рублей</h2>\n              <ol>\n                {\n                  cardsToCart.map((card, index) => {\n                  return <CartItem\n                            key={card.id}\n                            card={card}\n                            index={index}\n                            count={card.countAddToCart}\n                            sum={card.price * card.countAddToCart}\n                          />\n                  })\n                }\n              </ol>\n            </>\n          )\n        : <p>Корзина пуста</p>\n      }\n    </div>\n  )\n}\n\nexport default Cart;","export function storage(key, data) {\n  if (!data) {\n    return JSON.parse(localStorage.getItem(key));\n  }\n\n  localStorage.setItem(key, JSON.stringify(data));\n}\n\n\nexport function clearStorage() {\n  localStorage.clear();\n  window.location.reload();\n};","import React, { useEffect } from 'react';\nimport './App.css';\nimport Button from './components/Button/Button';\nimport CardList from './components/CardList/CardList'\nimport Cart from './components/Cart/Cart';\nimport Context from './context';\nimport { storage, clearStorage } from './utils/storage';\n\nconsole.log(storage, clearStorage);\n\nfunction App() {\n  const MIN_COUNT_CARD = 0;\n  const [cards, setCards] = React.useState(storage('cards') || []);\n  const [loading, setLoading] = React.useState(true);\n  const [categoryCount, setCategoryCount] = React.useState(0);\n\n  function recalculateCategoty(cards) {\n    return cards.filter(card => {\n      return checkAmount(card);\n    }).length;\n  }\n\n  function checkAmount(card) {\n    const cartCount = card.countAddToCart || 0;\n    return (card.amount - cartCount) > 0 && (card.maxPerPerson - cartCount) > 0;\n  }\n\n  useEffect(() => {\n    if (cards.length) {\n      setCards(cards);\n      setCategoryCount(recalculateCategoty(cards))\n      setLoading(false)\n    } else {\n      fetch('https://my-json-server.typicode.com/alex-koshara/travelata_testing/products?_limit=5')\n        .then(response => response.json())\n        .then(cards => {\n          setCards(cards)\n          setCategoryCount(recalculateCategoty(cards))\n          setLoading(false)\n        })\n    }\n  }, [])\n\n\n  useEffect(() => {\n    setCategoryCount(recalculateCategoty(cards))\n    setCards(cards)\n\n    storage('cards', cards);\n  }, [cards])\n\n  function setCountCardToCart(card, operation) {\n    card.countAddToCart = card.countAddToCart || MIN_COUNT_CARD;\n    switch (operation) {\n      case 'add':\n        return card.countAddToCart++;\n      case 'remove':\n        return card.countAddToCart--;\n      case 'clear':\n        return card.countAddToCart = 0;\n      default:\n        return;\n    }\n  }\n\n  function getCurrentCard(cards, id) {\n    return cards.find(card => card.id === id);\n  }\n\n  function setCart(id, operation) {\n    const currentCard = getCurrentCard(cards, id);\n    setCountCardToCart(currentCard, operation);\n\n    setCards(cards.map(card => {\n      if (card.id === currentCard.id) {\n        cards.countAddToCart = currentCard.countAddToCart;\n      }\n\n      return card;\n    }))\n  }\n\n  return (\n    <Context.Provider value={{ setCart }}>\n      <div className=\"container\">\n        {\n          cards.length\n          ? (<div className=\"main\">\n              <CardList cards={cards} categoryCount={categoryCount} />\n              <Cart cards={cards} />\n              <Button\n                  clickHandler={clearStorage}\n                  classButton='button--clear'\n                  operation='clear'\n                  content='Очистить localStorage'/>\n            </div>)\n          : (loading ? null : <p>No cards</p>)\n        }\n      </div>\n    </Context.Provider>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}