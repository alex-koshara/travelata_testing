{"version":3,"sources":["context.js","components/Button/Button.js","components/Card/Card.js","components/CardList/CardList.js","components/CartItem/CartItem.js","components/Cart/Cart.js","utils/storage.js","App.js","index.js"],"names":["Context","React","createContext","Button","content","clickHandler","id","disabled","operation","classButton","onClick","className","Card","card","index","setCart","useContext","amount","countAddToCart","amountPerPerson","maxPerPerson","isDisabledCardButton","isMaxPerPerson","productName","price","class","CardList","cards","categoryCount","map","CartItem","count","sum","Cart","cardsToCart","filter","cartSum","reduce","cardCount","length","storage","key","data","JSON","parse","localStorage","getItem","setItem","stringify","App","useState","setCards","loading","setLoading","setCategoryCount","recalculateCategoty","cartCount","checkAmount","useEffect","fetch","then","response","json","Provider","value","currentCard","find","getCurrentCard","setCountCardToCart","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.43400344.chunk.js","sourcesContent":["import React from 'react';\n\nconst Context = React.createContext();\n\nexport default Context;\n","import React from 'react';\nimport './Button.css'\n\nfunction Button({content, clickHandler, id, disabled, operation, classButton}) {\n  return (\n      <button\n        onClick={() => clickHandler(id, operation)}\n        className={\"button \" + (disabled ? 'button--disabled ' : '') + classButton}\n        disabled={disabled}>\n          {content}\n      </button>\n  )\n}\n\nexport default Button;","import React, { useContext } from 'react';\nimport './Card.css';\nimport Context from '../../context';\nimport Button from '../Button/Button';\n\nfunction Card({card, index}) {\n  const {setCart} = useContext(Context);\n  const amount = card.amount - (card.countAddToCart || 0);\n  const amountPerPerson = card.maxPerPerson === (card.countAddToCart || 0);\n  const isDisabledCardButton = !amount || amountPerPerson;\n  const isMaxPerPerson = amount > 0 && amountPerPerson;\n\n  return (\n    <li className=\"card\">\n      <p className=\"card__wrap\">\n        <b className=\"card__index\">{index + 1}</b>\n        <span className=\"card__text\">Осталось {amount} {card.productName} по {card.price} рублей</span>\n        <Button\n          id={card.id}\n          disabled={isDisabledCardButton}\n          clickHandler={setCart}\n          classButton='card__button'\n          operation='add'\n          content='Добавить в корзину'/>\n      </p>\n      {isMaxPerPerson && <span class=\"card__max-per-person\">К сожалению данный товар ограничен за одну покупку. Вы можете приобрести не более {card.maxPerPerson} шт.</span>}\n    </li>\n  )\n}\n\nexport default Card;","import React from 'react';\nimport './CardList.css'\nimport Card from '../Card/Card';\n\nfunction CardList({cards, categoryCount}) {\n\n  return (\n    <section className=\"card-list\">\n      <h2>Имеющиеся категории товаров {categoryCount}</h2>\n      <ul className=\"card-list__list\">\n        {cards.map((card, index) => {\n          return (\n            <Card\n              key={card.id}\n              card={card}\n              index={index}\n            />\n          )\n        })}\n      </ul>\n    </section>\n  )\n}\n\nexport default CardList;","import React, { useContext } from 'react';\nimport './CartItem.css'\nimport Context from '../../context';\nimport Button from '../Button/Button';\n\nfunction CartItem({card, count, sum}) {\n  const {setCart} = useContext(Context);\n  const amountPerPerson = card.maxPerPerson === (card.countAddToCart || 0);\n  const isDisabledCardButton = amountPerPerson;\n\n  return (\n      <li className=\"CartItem\">\n        <p>Телефон (\n          <Button\n            id={card.id}\n            clickHandler={setCart}\n            classButton='cart-item__button-remove'\n            operation='remove'\n            content='-'/>\n              {count} шт\n          <Button\n            id={card.id}\n            clickHandler={setCart}\n            disabled={isDisabledCardButton}\n            classButton='cart-item__button-add'\n            operation='add'\n            content='+'/>\n              ) на сумму {sum} рублей (\n          <Button\n            id={card.id}\n            clickHandler={setCart}\n            operation='clear'\n            content='удалить'/>\n          )\n        </p>\n      </li>\n  )\n}\n\nexport default CartItem;","import React from 'react';\nimport CartItem from '../CartItem/CartItem';\nimport './Cart.css'\n\nfunction Cart({cards}) {\n  const cardsToCart = cards.filter(card => card.countAddToCart);\n  const cartSum = cardsToCart.reduce((sum, card) => {\n    return sum + (card.countAddToCart * card.price)\n  }, 0);\n  const cardCount = cardsToCart.reduce((sum, card) => {\n    return sum + card.countAddToCart\n  }, 0)\n\n  return (\n    <div className=\"cart\">\n      {\n        cardsToCart.length\n        ? (\n            <>\n              <h2>В корзине {cardCount} товаров на сумму {cartSum} рублей</h2>\n              <ol>\n                {\n                  cardsToCart.map((card, index) => {\n                  return <CartItem\n                            key={card.id}\n                            card={card}\n                            index={index}\n                            count={card.countAddToCart}\n                            sum={card.price * card.countAddToCart}\n                          />\n                  })\n                }\n              </ol>\n            </>\n          )\n        : <p>Корзина пуста</p>\n      }\n    </div>\n  )\n}\n\nexport default Cart;","function storage(key, data) {\n  if (!data) {\n    return JSON.parse(localStorage.getItem(key));\n  }\n\n  localStorage.setItem(key, JSON.stringify(data));\n}\n\nexport default storage;","import React, { useEffect } from 'react';\nimport './App.css';\nimport CardList from './components/CardList/CardList'\nimport Cart from './components/Cart/Cart';\nimport Context from './context';\nimport storage from './utils/storage';\n\nfunction App() {\n  const MIN_COUNT_CARD = 0;\n  const [cards, setCards] = React.useState(storage('cards') || []);\n  const [loading, setLoading] = React.useState(true);\n  const [categoryCount, setCategoryCount] = React.useState(0);\n\n  function recalculateCategoty(cards) {\n    return cards.filter(card => {\n      return checkAmount(card);\n    }).length;\n  }\n\n  function checkAmount(card) {\n    const cartCount = card.countAddToCart || 0;\n    return (card.amount - cartCount) > 0 && (card.maxPerPerson - cartCount) > 0;\n  }\n\n  useEffect(() => {\n    if (cards.length) {\n      setCards(cards);\n      setCategoryCount(recalculateCategoty(cards))\n      setLoading(false)\n    } else {\n      fetch('https://my-json-server.typicode.com/alex-koshara/travelata_testing/products?_limit=5')\n        .then(response => response.json())\n        .then(cards => {\n          setCards(cards)\n          setCategoryCount(recalculateCategoty(cards))\n          setLoading(false)\n        })\n    }\n  }, [])\n\n\n  useEffect(() => {\n    setCategoryCount(recalculateCategoty(cards))\n    setCards(cards)\n\n    storage('cards', cards);\n  }, [cards])\n\n  function setCountCardToCart(card, operation) {\n    card.countAddToCart = card.countAddToCart || MIN_COUNT_CARD;\n    switch (operation) {\n      case 'add':\n        return card.countAddToCart++;\n      case 'remove':\n        return card.countAddToCart--;\n      case 'clear':\n        return card.countAddToCart = 0;\n      default:\n        return;\n    }\n  }\n\n  function getCurrentCard(cards, id) {\n    return cards.find(card => card.id === id);\n  }\n\n  function setCart(id, operation) {\n    const currentCard = getCurrentCard(cards, id);\n    setCountCardToCart(currentCard, operation);\n\n    setCards(cards.map(card => {\n      if (card.id === currentCard.id) {\n        cards.countAddToCart = currentCard.countAddToCart;\n      }\n\n      return card;\n    }))\n  }\n\n  return (\n    <Context.Provider value={{ setCart }}>\n      <div className=\"container\">\n        {\n          cards.length\n          ? (<div className=\"main\">\n              <CardList cards={cards} categoryCount={categoryCount} />\n              <Cart cards={cards} />\n            </div>)\n          : (loading ? null : <p>No cards</p>)\n        }\n      </div>\n    </Context.Provider>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n"],"sourceRoot":""}